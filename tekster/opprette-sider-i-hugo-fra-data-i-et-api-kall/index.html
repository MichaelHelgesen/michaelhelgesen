<!DOCTYPE html>
<html lang="nb">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    

    <title>Opprette sider i Hugo via API</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

    <body>
    
    




<header>
    <div class="logo">
        <a href="/">
            MH
        </a>
    </div>
    <div>
    <nav>
        <ul>
<li>
      <a href="/">Hjem</a>
    </li>
<li>
      <a aria-current="true" class="ancestor" href="/tekster/">Tekster</a>
    </li>
<li>
      <a href="/journal/">Journal</a>
    </li>
<li>
      <a href="/laeringslogg/">Læringslogg</a>
    </li>
<li>
      <a href="/emneknagger/">Emneknagger</a>
    </li>
<li>
      <a href="/kilder/">Kilder</a>
    </li>
<li>
      <a href="/bibliotek/">Bibliotek</a>
    </li>
<li>
      <a href="/lenker/">Lenker</a>
    </li>
<li>
      <a href="/na/">Nå</a>
    </li>
<li>
      <a href="/om/">Om</a>
    </li>
        </ul>
    </nav>
        
           






    <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="/">
                    <span itemprop="name">Hjem</span></a>
                /&nbsp;
                <meta itemprop="position" content='1' />
            </li>
            <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="/tekster/">
                    <span itemprop="name">Tekster</span></a>
                /&nbsp;
                <meta itemprop="position" content='2' />
            </li>
            <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a itemprop="item" href="/tekster/opprette-sider-i-hugo-fra-data-i-et-api-kall/">
                    <span itemprop="name">Opprette sider i Hugo via API</span>
                </a>
                <meta itemprop="position" content='3' />
            </li>
    </ol>
    

        
    </div>
</header>
 
   

   
   <main>
           
    
        <div class="intro blogg">
    
    
        <h1>Opprette sider i Hugo via API</h1>
        <p class="last-posts-list__meta">
            
                <span>Red: 9. aug. 2024 | </span>
            
            <span>Pub: 19. apr. 2024 | </span>    
             
 

    
    
         <a href="/emneknagger/tekstemner/hugo/"> 
        
        #hugo</a>, 
         <a href="/emneknagger/tekstemner/api/"> 
        
        #api</a>, 
         <a href="/emneknagger/tekstemner/zotero/"> 
        
        #zotero</a>, 
         <a href="/emneknagger/tekstemner/programmering/"> 
        
            #programmering</a>
        


        </p>
    
        </div>
<article>
    
        
            <p class="ingress">Det er i utgangspunktet ikke mulig å opprette sider i Hugo via et API, men det finnes måter å komme rundt problemet.</p>
        
    <p>Under opprettelsen av denne bloggen hadde jeg et ønske om å koble til <a href="https://zotero.org" target="_blank" class="external_link">Zotero<svg width="14px" height="14px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g id="Interface / External_Link">
<path id="Vector" d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </g></svg></a>, slik at alle kilder jeg har benyttet og henviser til i tekster automatisk konverteres til sider i Hugo.</p>
<p>Etter litt søking forsto jeg at det å opprette sider basert på en ekstern kilde under byggingen av et Hugo-nettsted lenge har blitt sett på som et av Hugos største begrensninger. Operasjonen har alltid krevd en to-stegs prosess.</p>
<p>Årsaken til dette er at Hugo baserer seg på «markdown»-filer, og disse filene må være tilgjengelig i det man kjører <code>hugo</code>-kommandoen. Dermed har man delt denne prosessen i to, ved at man først henter ekstern data og lager «markdown»-filer via et skript. Deretter har man kjørt bygge-kommandoen med filene generert i steg en.</p>
<p>Det fungerer fint, men basert på en <a href="https://www.thenewdynamic.com/article/toward-using-a-headless-cms-with-hugo-part-2-building-from-remote-api/" target="_blank" class="external_link">artikkel<svg width="14px" height="14px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g id="Interface / External_Link">
<path id="Vector" d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </g></svg></a> jeg fant er det mulig å gjøre alt dette i Hugo, i en og samme operasjon, selv om det fortsatt i praksis er to steg.</p>
<h2 id="hugo-i-hugo">Hugo i Hugo</h2>
<p>Denne fremgangsmåten benytter to Hugo-instanser. Vi har hovedprosjektet, som benyttes til å generere nettsiden, samt en versjon som kun benyttes til å hente ekstern data og generere «markdown»-filer.</p>
<p>For ordens skyld oppretter vi sistnevnte som en mappe i hovedprosjektet vårt <code>/prebuild</code>.
I denne mappen oppretter vi</p>
<ul>
<li><code>config.yaml</code>: for innstillinger, og muligheten for å kjøre <code>hugo</code>-kommandoen</li>
<li><code>/layouts/index.html</code> for API-tilkoblingen og «markdown»-generering</li>
</ul>
<h3 id="hente-ekstern-data">Hente ekstern data</h3>
<p>I <code>layouts/index.html</code> starter vi med å koble til det eksterne API-et:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>{{ <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">resources</span>.<span style="color:#a6e22e">GetRemote</span> <span style="color:#e6db74">&#34;https://api.zotero.org/groups/5454933/collections/U68Q8VUJ/items/top?format=json&#34;</span>}}
</span></span><span style="display:flex;"><span>{{ <span style="color:#a6e22e">end</span> }}
</span></span></code></pre></div><p>Her benyttes <code>resources.GetRemote</code> som er <a href="https://gohugo.io/functions/resources/getremote/" target="_blank" class="external_link">Hugos funksjon for å hente data<svg width="14px" height="14px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g id="Interface / External_Link">
<path id="Vector" d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </g></svg></a>. Vi legger <code>with</code> foran, som binder konteksten til API-kallet. Det vil si at koden i blokken kjøres så fremt API-kallet mottar data.</p>
<blockquote>
<p>(with) Binds context (the dot) to the expression and executes the block if expression is truthy.<br>
<em><a href="https://gohugo.io/functions/go-template/with/" target="_blank" class="external_link">Hugo<svg width="14px" height="14px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g id="Interface / External_Link">
<path id="Vector" d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </g></svg></a></em></p>
</blockquote>
<p>Hvis kallet er vellykket, må vi utføre en del handlinger med dataene vi mottar.</p>
<h3 id="opprette-markdown-filer">Opprette «markdown»-filer</h3>
<p>Hugo har en rekke funksjoner som kan hjelpe oss i prosessen med å opprette filer. Den komplette koden er som følger:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>{{ <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">resources</span>.<span style="color:#a6e22e">GetRemote</span> <span style="color:#e6db74">&#34;https://api.zotero.org/groups/5454933/collections/U68Q8VUJ/items/top?format=json&#34;</span>}}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">with</span> .<span style="color:#a6e22e">Content</span> }} 
</span></span><span style="display:flex;"><span>        {{ <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">transform</span>.<span style="color:#a6e22e">Unmarshal</span> . }}
</span></span><span style="display:flex;"><span>            {{ <span style="color:#66d9ef">range</span> . }}
</span></span><span style="display:flex;"><span>                {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">string</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jsonify</span> . }} 
</span></span><span style="display:flex;"><span>                {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">filename</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">printf</span> <span style="color:#e6db74">&#34;sources/%s.md&#34;</span> (<span style="color:#a6e22e">urlize</span> .<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">title</span>) }} 
</span></span><span style="display:flex;"><span>                {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">resource</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">resources</span>.<span style="color:#a6e22e">FromString</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">filename</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">string</span> }} 
</span></span><span style="display:flex;"><span>                {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">file</span> <span style="color:#f92672">:=</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">resource</span>.<span style="color:#a6e22e">RelPermalink</span> }} 
</span></span><span style="display:flex;"><span>            {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>        {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>{{ <span style="color:#a6e22e">end</span> }}
</span></span></code></pre></div><ol>
<li><code>{{ with .Content }}</code>: Vi angir innholdet i API-kallet som kontekst.</li>
<li><code>{{ with transform.Unmarshal . }}</code>: En funksjon som endrer JSON-strengen fra API-kallet til et objekt som Hugo forstår, og som lar oss benytte andre Hugo funksjoner og metoder på dataene. Vi angir også dette objektet som kontekst med <code>with</code>.</li>
<li><code>{{ range . }}</code>: En loop som, i dette tilfellet, lar oss utføre handlinger på alle kilder i listen vi har hentet via API-kallet.</li>
<li><code>{{ $string := jsonify .}}</code>: Generere JSON-streng av kilden.</li>
<li><code>{{ $filename := printf &quot;kilder/%s.md&quot; (urlize .data.title) }}</code>: Vi oppretter et filnavn til den kommende «markdown»-filen.</li>
<li><code>{{ $resource := resources.FromString $filename $string }}</code>: Denne funksjonen genererer «markdown»-ressursen basert på variablene vi opprettet over.</li>
<li><code>{{ $file := $resource.RelPermalink }}</code>: Funksjonen som faktisk publiserer ressursen vi oppretter over.</li>
</ol>
<p>Koden kan også kortes ned på følgende måte:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>{{ <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">resources</span>.<span style="color:#a6e22e">GetRemote</span> <span style="color:#e6db74">&#34;https://api.zotero.org/groups/5454933/collections/U68Q8VUJ/items/top?format=json&#34;</span>}}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">sources</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">unmarshal</span> .<span style="color:#a6e22e">Content</span> }}
</span></span><span style="display:flex;"><span>        {{ <span style="color:#66d9ef">range</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">sources</span> }}
</span></span><span style="display:flex;"><span>            {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">string</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jsonify</span> . }} 
</span></span><span style="display:flex;"><span>            {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">filename</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">printf</span> <span style="color:#e6db74">&#34;sources/%s.md&#34;</span> (<span style="color:#a6e22e">urlize</span> .<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">title</span>) }} 
</span></span><span style="display:flex;"><span>            {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">resource</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">resources</span>.<span style="color:#a6e22e">FromString</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">filename</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">string</span> }} 
</span></span><span style="display:flex;"><span>            {{ <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">file</span> <span style="color:#f92672">:=</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">resource</span>.<span style="color:#a6e22e">RelPermalink</span> }} 
</span></span><span style="display:flex;"><span>        {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>{{ <span style="color:#a6e22e">end</span> }}
</span></span></code></pre></div><h4 id="json-som-frontmatter">JSON som «frontmatter»</h4>
<p>En ting som er viktig å forstå i prosessen over, er at «markdown»-filene vi oppretter inneholder en JSON-streng med data fra API-et (steg 4 og 6).</p>
<p>Denne JSON-strengen blir tolket som «frontmatter» av Hugo. Det vurderes altså som metadata, og vil ikke vises via <code>{{ .Content }}</code>-metoden.</p>
<p>Og i dette tilfellet er JSON-strengen stor og vanskelig å lese, men det er ikke så farlig så lenge det kun er Hugo, og ikke mennesker som skal tyde den, men det er mulig å lage den mer oversiktlig ved behov.</p>
<p>Slik ser JSON-frontmatter ut i dette tilfellet:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;data&#34;</span>:{<span style="color:#f92672">&#34;ISBN&#34;</span>:<span style="color:#e6db74">&#34;9780671212094 9781476790152&#34;</span>,<span style="color:#f92672">&#34;abstractNote&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;accessDate&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;archive&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;archiveLocation&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;callNumber&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;collections&#34;</span>:[<span style="color:#e6db74">&#34;U68Q8VUJ&#34;</span>],<span style="color:#f92672">&#34;creators&#34;</span>:[{<span style="color:#f92672">&#34;creatorType&#34;</span>:<span style="color:#e6db74">&#34;author&#34;</span>,<span style="color:#f92672">&#34;firstName&#34;</span>:<span style="color:#e6db74">&#34;Mortimer Jerome&#34;</span>,<span style="color:#f92672">&#34;lastName&#34;</span>:<span style="color:#e6db74">&#34;Adler&#34;</span>},{<span style="color:#f92672">&#34;creatorType&#34;</span>:<span style="color:#e6db74">&#34;author&#34;</span>,<span style="color:#f92672">&#34;firstName&#34;</span>:<span style="color:#e6db74">&#34;Charles Lincoln&#34;</span>,<span style="color:#f92672">&#34;lastName&#34;</span>:<span style="color:#e6db74">&#34;Van Doren&#34;</span>}],<span style="color:#f92672">&#34;date&#34;</span>:<span style="color:#e6db74">&#34;2014&#34;</span>,<span style="color:#f92672">&#34;dateAdded&#34;</span>:<span style="color:#e6db74">&#34;2024-03-19T17:12:51Z&#34;</span>,<span style="color:#f92672">&#34;dateModified&#34;</span>:<span style="color:#e6db74">&#34;2024-03-19T17:12:51Z&#34;</span>,<span style="color:#f92672">&#34;edition&#34;</span>:<span style="color:#e6db74">&#34;Touchstone edition&#34;</span>,<span style="color:#f92672">&#34;extra&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;itemType&#34;</span>:<span style="color:#e6db74">&#34;book&#34;</span>,<span style="color:#f92672">&#34;key&#34;</span>:<span style="color:#e6db74">&#34;KDJ8DIH4&#34;</span>,<span style="color:#f92672">&#34;language&#34;</span>:<span style="color:#e6db74">&#34;eng&#34;</span>,<span style="color:#f92672">&#34;libraryCatalog&#34;</span>:<span style="color:#e6db74">&#34;K10plus ISBN&#34;</span>,<span style="color:#f92672">&#34;numPages&#34;</span>:<span style="color:#e6db74">&#34;424&#34;</span>,<span style="color:#f92672">&#34;numberOfVolumes&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;place&#34;</span>:<span style="color:#e6db74">&#34;New York&#34;</span>,<span style="color:#f92672">&#34;publisher&#34;</span>:<span style="color:#e6db74">&#34;Touchstone&#34;</span>,<span style="color:#f92672">&#34;relations&#34;</span>:{},<span style="color:#f92672">&#34;rights&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;series&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;seriesNumber&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;shortTitle&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;tags&#34;</span>:[],<span style="color:#f92672">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;How to read a book&#34;</span>,<span style="color:#f92672">&#34;url&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">11</span>,<span style="color:#f92672">&#34;volume&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>},<span style="color:#f92672">&#34;key&#34;</span>:<span style="color:#e6db74">&#34;KDJ8DIH4&#34;</span>,<span style="color:#f92672">&#34;library&#34;</span>:{<span style="color:#f92672">&#34;id&#34;</span>:<span style="color:#ae81ff">5454933</span>,<span style="color:#f92672">&#34;links&#34;</span>:{<span style="color:#f92672">&#34;alternate&#34;</span>:{<span style="color:#f92672">&#34;href&#34;</span>:<span style="color:#e6db74">&#34;https://www.zotero.org/groups/mikkesblogg&#34;</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;text/html&#34;</span>}},<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;mikkesblogg&#34;</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;group&#34;</span>},<span style="color:#f92672">&#34;links&#34;</span>:{<span style="color:#f92672">&#34;alternate&#34;</span>:{<span style="color:#f92672">&#34;href&#34;</span>:<span style="color:#e6db74">&#34;https://www.zotero.org/groups/mikkesblogg/items/KDJ8DIH4&#34;</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;text/html&#34;</span>},<span style="color:#f92672">&#34;self&#34;</span>:{<span style="color:#f92672">&#34;href&#34;</span>:<span style="color:#e6db74">&#34;https://api.zotero.org/groups/5454933/items/KDJ8DIH4&#34;</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;application/json&#34;</span>}},<span style="color:#f92672">&#34;meta&#34;</span>:{<span style="color:#f92672">&#34;createdByUser&#34;</span>:{<span style="color:#f92672">&#34;id&#34;</span>:<span style="color:#ae81ff">9890568</span>,<span style="color:#f92672">&#34;links&#34;</span>:{<span style="color:#f92672">&#34;alternate&#34;</span>:{<span style="color:#f92672">&#34;href&#34;</span>:<span style="color:#e6db74">&#34;https://www.zotero.org/mikke02&#34;</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;text/html&#34;</span>}},<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;Mikke02&#34;</span>},<span style="color:#f92672">&#34;creatorSummary&#34;</span>:<span style="color:#e6db74">&#34;Adler and Van Doren&#34;</span>,<span style="color:#f92672">&#34;numChildren&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;parsedDate&#34;</span>:<span style="color:#e6db74">&#34;2014&#34;</span>},<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">11</span>}
</span></span></code></pre></div><h3 id="forenkle-bygge-kommandoen">Forenkle bygge-kommandoen</h3>
<p>Før vi kjører <code>hugo</code>-kommandoen og oppretter filene er det en fordel å forenkle oppsettet, lik at vi skaper en så minimalistisk og kjapp byggeprosess som mulig. Denne Hugo-instansen skal jo kun benyttes til å skape «markdown»-filer.</p>
<p>I <code>prebuild/config.yaml</code> anbefales det å angi følgende:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">disableKinds</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">sitemap</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">taxonomy</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">term</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">outputs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">home</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">html</span>
</span></span></code></pre></div><p>Da er alt klart, og vi kan kjøre <code>hugo</code>-kommandoen fra <code>/prebuild</code>-mappen.</p>
<p>I mappen <code>prebuild/public/kilder</code> ligger så alle bøkene hentet fra Zotero via API-et.</p>
<h2 id="inkludere-nyopprettede-filer-i-hovedprosjektet">Inkludere nyopprettede filer i hovedprosjektet</h2>
<p>Hovedinstallasjonen av Hugo skjønner ikke at det ligger «markdown»-filer i <code>/prebuild/public/kilder</code>, så vi må angi dette i <code>config.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">module</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mounts</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">source</span>: <span style="color:#ae81ff">content</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">target</span>: <span style="color:#ae81ff">content</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">source</span>: <span style="color:#ae81ff">prebuild/public/kilder</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">target</span>: <span style="color:#ae81ff">content/kilder</span>
</span></span></code></pre></div><h3 id="oppdatere-maler">Oppdatere maler</h3>
<p>Som nevnt i avsnittet JSON som «frontmatter» ligger all data fra API-kallet som metadata i de nyopprettede «markdown»-filene.</p>
<p>Det vil si at vi må bruke <code>Params</code> som nøkkel i malene, som her i <code>/layouts/kilder/index.html</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>{{ <span style="color:#a6e22e">define</span> <span style="color:#e6db74">&#34;main&#34;</span> }}
</span></span><span style="display:flex;"><span>{{ .<span style="color:#a6e22e">Content</span> }}    
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">ul</span>&gt;
</span></span><span style="display:flex;"><span>    {{ <span style="color:#66d9ef">range</span> .<span style="color:#a6e22e">Pages</span>}}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#a6e22e">li</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a6e22e">a</span> <span style="color:#a6e22e">href</span>=<span style="color:#e6db74">&#34;{{ .Page.Permalink }}&#34;</span>&gt;&lt;<span style="color:#a6e22e">h2</span> <span style="color:#a6e22e">id</span>={{.<span style="color:#a6e22e">Title</span>}}&gt;{{ .<span style="color:#a6e22e">Params</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">title</span> }}&lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">h2</span>&gt;&lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">a</span>&gt;
</span></span><span style="display:flex;"><span>        {{ <span style="color:#66d9ef">range</span> .<span style="color:#a6e22e">Params</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">creators</span> }}
</span></span><span style="display:flex;"><span>            {{ .<span style="color:#a6e22e">firstName</span> }} {{ .<span style="color:#a6e22e">lastName</span> }} 
</span></span><span style="display:flex;"><span>        {{ <span style="color:#a6e22e">end</span>}}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">li</span>&gt;
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">end</span> }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">ul</span>&gt;
</span></span><span style="display:flex;"><span>{{ <span style="color:#a6e22e">end</span> }}
</span></span></code></pre></div><h3 id="slå-sammen-prosessen-til-en-kommando">Slå sammen prosessen til en kommando</h3>
<p>For at dette skal virke må vi først kjøre <code>hugo</code>-kommandoen fra <code>/prebuild</code>-mappen, og deretter fra hovedprosjektet. Dette kan vi slå sammen på følgende måte:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>hugo -s prebuild &amp;&amp; hugo
</span></span></code></pre></div><p><code>-s</code> er en forkortelse for <code>--source</code> og angir hva som skal bygges først.</p>
<p>Det er det hele. Nå kan du lage Hugo-sider med masse spennende innhold fra eksterne API-er.</p>
</article>
<hr class="single">
<section class="mail">
<h5>Ris, ros eller respons?</h5>
<p>Send meg gjerne <a href="mailto:mikke@mikke.no?subject=Opprette%20sider%20i%20Hugo%20via%20API">df</a> om du har en kommentar, korrektur eller konstruktiv kritikk til denne saken. 
</section>




    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


<hr class="single">
    <section class="backlinks">
        <h5>Andre tekster som henviser til denne: </h5>
        <nav>
            <ul class="taglist single">
                
                <li>
            <a href="/journal/sider-fra-data-i-hugo/">
            <h6>Endelig mulig å opprette sider i HUGO fra ekstern data!</h6>
            <div>
                <p class="last-posts-list__meta">
                <span style="font-weight: 600">Journal</span> | 
                
                <span>Red: 9. aug. 2024 | </span>
                
                <span>Pub: 21. mai 2024</span>    
                </p>
            </div>
            </a>
        </li>
                
            </ul>
        </nav>
    </section>


   </main>
   

    
        





<footer class="mt-16 border-t border-white text-center pt-8 pb-4"> 
    <nav>
        <ul>
<li>
      <a href="/">Hjem</a>
    </li>
<li>
      <a aria-current="true" class="ancestor" href="/tekster/">Tekster</a>
    </li>
<li>
      <a href="/journal/">Journal</a>
    </li>
<li>
      <a href="/laeringslogg/">Læringslogg</a>
    </li>
<li>
      <a href="/emneknagger/">Emneknagger</a>
    </li>
<li>
      <a href="/kilder/">Kilder</a>
    </li>
<li>
      <a href="/bibliotek/">Bibliotek</a>
    </li>
<li>
      <a href="/lenker/">Lenker</a>
    </li>
<li>
      <a href="/na/">Nå</a>
    </li>
<li>
      <a href="/om/">Om</a>
    </li>
        </ul>
    </nav>
    <p>Nettsiden er laget av <a href="/om">meg</a>, med <a href="https://www.gohugo.io">Hugo</a>.</p>
    <p>Her finnes ingen sporingsmekanismer, bare deg og meg.</p> 
</footer>


   
</body>
</html>
